// Enhanced NIST AI RMF to OWASP AISVS Mapping with NIST 800-53 Rev 5 Controls and MITRE ATLAS

export const nistAisvsMapping = {
  nodes: [
    // NIST AI RMF Functions
    { id: 'GOVERN', type: 'nist-function', label: 'Govern', description: 'Establish organizational policies and procedures' },
    { id: 'MAP', type: 'nist-function', label: 'Map', description: 'Identify and document AI system context' },
    { id: 'MEASURE', type: 'nist-function', label: 'Measure', description: 'Analyze, assess, and monitor AI risks' },
    { id: 'MANAGE', type: 'nist-function', label: 'Manage', description: 'Prioritize and respond to AI risks' },
    
    // NIST AI RMF Subcategories (expanded)
    { id: 'GOVERN.1.1', type: 'nist-subcategory', label: 'Legal & Regulatory Requirements', description: 'Compliance with applicable laws and regulations' },
    { id: 'GOVERN.1.2', type: 'nist-subcategory', label: 'Organizational Policies', description: 'Establish AI governance policies' },
    { id: 'MAP.1.1', type: 'nist-subcategory', label: 'AI System Inventory', description: 'Document AI systems and components' },
    { id: 'MAP.1.2', type: 'nist-subcategory', label: 'Risk Assessment Scope', description: 'Define risk assessment boundaries' },
    { id: 'MEASURE.1.1', type: 'nist-subcategory', label: 'Risk Measurement Criteria', description: 'Establish risk measurement frameworks' },
    { id: 'MEASURE.2.1', type: 'nist-subcategory', label: 'Continuous Monitoring', description: 'Monitor AI system performance and risks' },
    { id: 'MANAGE.1.1', type: 'nist-subcategory', label: 'Risk Response Planning', description: 'Develop risk response strategies' },
    { id: 'MANAGE.2.1', type: 'nist-subcategory', label: 'Incident Response', description: 'Respond to AI security incidents' },
    
    // NIST 800-53 Rev 5 Control Families (AI-relevant)
    { id: 'AC', type: 'nist-80053-family', label: 'Access Control', description: 'Control access to AI systems and data' },
    { id: 'AU', type: 'nist-80053-family', label: 'Audit & Accountability', description: 'Logging and monitoring of AI activities' },
    { id: 'CM', type: 'nist-80053-family', label: 'Configuration Management', description: 'Manage AI system configurations' },
    { id: 'IA', type: 'nist-80053-family', label: 'Identification & Authentication', description: 'Authenticate AI system users' },
    { id: 'IR', type: 'nist-80053-family', label: 'Incident Response', description: 'Respond to AI security incidents' },
    { id: 'RA', type: 'nist-80053-family', label: 'Risk Assessment', description: 'Assess AI system risks' },
    { id: 'SA', type: 'nist-80053-family', label: 'System & Services Acquisition', description: 'Acquire secure AI components' },
    { id: 'SC', type: 'nist-80053-family', label: 'System & Communications Protection', description: 'Protect AI communications' },
    { id: 'SI', type: 'nist-80053-family', label: 'System & Information Integrity', description: 'Maintain AI system integrity' },
    { id: 'SR', type: 'nist-80053-family', label: 'Supply Chain Risk Management', description: 'Manage AI supply chain risks' },
    
    // NIST 800-53 Rev 5 Specific Controls (AI-relevant)
    { id: 'AC-2', type: 'nist-80053-control', label: 'Account Management', description: 'Manage AI system accounts' },
    { id: 'AC-3', type: 'nist-80053-control', label: 'Access Enforcement', description: 'Enforce access controls for AI systems' },
    { id: 'AU-2', type: 'nist-80053-control', label: 'Audit Events', description: 'Audit AI system events' },
    { id: 'CM-6', type: 'nist-80053-control', label: 'Configuration Settings', description: 'Configure AI system settings' },
    { id: 'IA-2', type: 'nist-80053-control', label: 'Identification & Authentication', description: 'Authenticate AI system access' },
    { id: 'IR-4', type: 'nist-80053-control', label: 'Incident Handling', description: 'Handle AI security incidents' },
    { id: 'RA-2', type: 'nist-80053-control', label: 'Security Categorization', description: 'Categorize AI system security' },
    { id: 'SA-11', type: 'nist-80053-control', label: 'Developer Security Testing', description: 'Test AI system security' },
    { id: 'SC-7', type: 'nist-80053-control', label: 'Boundary Protection', description: 'Protect AI system boundaries' },
    { id: 'SI-4', type: 'nist-80053-control', label: 'System Monitoring', description: 'Monitor AI system activities' },
    { id: 'SR-1', type: 'nist-80053-control', label: 'Supply Chain Risk Management', description: 'Manage AI supply chain' },
    
    // OWASP AISVS Categories (expanded)
    { id: 'C1', type: 'aisvs-category', label: 'C1: Training Data Governance', description: 'Govern training data security and privacy' },
    { id: 'C2', type: 'aisvs-category', label: 'C2: User Input Validation', description: 'Validate and sanitize user inputs' },
    { id: 'C3', type: 'aisvs-category', label: 'C3: Model Lifecycle Management', description: 'Manage model development and deployment' },
    { id: 'C4', type: 'aisvs-category', label: 'C4: Infrastructure & Configuration', description: 'Secure AI infrastructure' },
    { id: 'C5', type: 'aisvs-category', label: 'C5: Access Control', description: 'Control access to AI systems' },
    { id: 'C6', type: 'aisvs-category', label: 'C6: Secure Communication', description: 'Secure AI system communications' },
    { id: 'C7', type: 'aisvs-category', label: 'C7: Secure Output', description: 'Ensure secure AI outputs' },
    { id: 'C8', type: 'aisvs-category', label: 'C8: Supply Chain Security', description: 'Secure AI supply chain' },
    { id: 'C9', type: 'aisvs-category', label: 'C9: Autonomous Orchestration', description: 'Secure autonomous AI systems' },
    { id: 'C10', type: 'aisvs-category', label: 'C10: Adversarial Robustness', description: 'Protect against adversarial attacks' },
    { id: 'C11', type: 'aisvs-category', label: 'C11: Privacy Protection', description: 'Protect AI system privacy' },
    { id: 'C12', type: 'aisvs-category', label: 'C12: Secure Deployment', description: 'Secure AI system deployment' },
    { id: 'C13', type: 'aisvs-category', label: 'C13: Secure Operations', description: 'Secure AI system operations' },
    
    // MITRE ATLAS Tactics
    { id: 'RECONNAISSANCE', type: 'atlas-tactic', label: 'Reconnaissance', description: 'Gather information to plan future operations' },
    { id: 'RESOURCE-DEVELOPMENT', type: 'atlas-tactic', label: 'Resource Development', description: 'Establish resources to support operations' },
    { id: 'INITIAL-ACCESS', type: 'atlas-tactic', label: 'Initial Access', description: 'Gain entry into AI systems' },
    { id: 'AI-MODEL-ACCESS', type: 'atlas-tactic', label: 'AI Model Access', description: 'Gain access to AI models and capabilities' },
    { id: 'DISCOVERY', type: 'atlas-tactic', label: 'Discovery', description: 'Understand AI environment' },
    { id: 'AI-ATTACK-STAGING', type: 'atlas-tactic', label: 'AI Attack Staging', description: 'Prepare for AI-specific attacks' },
    { id: 'EXECUTION', type: 'atlas-tactic', label: 'Execution', description: 'Run malicious code on AI systems' },
    { id: 'PERSISTENCE', type: 'atlas-tactic', label: 'Persistence', description: 'Maintain foothold in AI systems' },
    { id: 'PRIVILEGE-ESCALATION', type: 'atlas-tactic', label: 'Privilege Escalation', description: 'Gain higher-level permissions' },
    { id: 'DEFENSE-EVASION', type: 'atlas-tactic', label: 'Defense Evasion', description: 'Avoid detection in AI systems' },
    { id: 'CREDENTIAL-ACCESS', type: 'atlas-tactic', label: 'Credential Access', description: 'Steal account credentials' },
    { id: 'COLLECTION', type: 'atlas-tactic', label: 'Collection', description: 'Gather data of interest' },
    { id: 'COMMAND-AND-CONTROL', type: 'atlas-tactic', label: 'Command & Control', description: 'Communicate with compromised systems' },
    { id: 'EXFILTRATION', type: 'atlas-tactic', label: 'Exfiltration', description: 'Steal data from AI systems' },
    { id: 'IMPACT', type: 'atlas-tactic', label: 'Impact', description: 'Manipulate, interrupt, or destroy AI systems' },
    
    // MITRE ATLAS Key Techniques (representative selection)
    { id: 'AML.T0000', type: 'atlas-technique', label: 'Search Open Technical Databases', description: 'Search technical databases for AI system information' },
    { id: 'AML.T0002', type: 'atlas-technique', label: 'Acquire Infrastructure', description: 'Acquire infrastructure for AI attacks' },
    { id: 'AML.T0010', type: 'atlas-technique', label: 'Exploit Public-Facing Application', description: 'Exploit public-facing applications for initial access' },
    { id: 'AML.T0040', type: 'atlas-technique', label: 'Access AI Model', description: 'Gain access to AI models' },
    { id: 'AML.T0013', type: 'atlas-technique', label: 'System Information Discovery', description: 'Discover AI system information' },
    { id: 'AML.T0005', type: 'atlas-technique', label: 'Stage Capabilities', description: 'Stage capabilities for AI attacks' },
    { id: 'AML.T0011', type: 'atlas-technique', label: 'User Execution', description: 'Execute malicious code in AI environments' },
    { id: 'AML.T0020', type: 'atlas-technique', label: 'Valid Accounts', description: 'Abuse valid accounts in AI systems' },
    { id: 'AML.T0053', type: 'atlas-technique', label: 'Exploitation for Privilege Escalation', description: 'Exploit vulnerabilities for privilege escalation' },
    { id: 'AML.T0015', type: 'atlas-technique', label: 'Impair Defenses', description: 'Impair defensive capabilities in AI systems' },
    { id: 'AML.T0055', type: 'atlas-technique', label: 'Unsecured Credentials', description: 'Search for unsecured credentials' },
    { id: 'AML.T0035', type: 'atlas-technique', label: 'Data from Information Repositories', description: 'Collect data from information repositories' },
    { id: 'AML.T0072', type: 'atlas-technique', label: 'Application Layer Protocol', description: 'Use application layer protocols for C2' },
    { id: 'AML.T0024', type: 'atlas-technique', label: 'Exfiltration Over C2 Channel', description: 'Exfiltrate data over C2 channels' },
    { id: 'AML.T0015-IMPACT', type: 'atlas-technique', label: 'Data Manipulation', description: 'Manipulate data to impact AI system integrity' },
  ],
  links: [
    // NIST AI RMF Function to Subcategory mappings
    { source: 'GOVERN', target: 'GOVERN.1.1', type: 'function-subcategory' },
    { source: 'GOVERN', target: 'GOVERN.1.2', type: 'function-subcategory' },
    { source: 'MAP', target: 'MAP.1.1', type: 'function-subcategory' },
    { source: 'MAP', target: 'MAP.1.2', type: 'function-subcategory' },
    { source: 'MEASURE', target: 'MEASURE.1.1', type: 'function-subcategory' },
    { source: 'MEASURE', target: 'MEASURE.2.1', type: 'function-subcategory' },
    { source: 'MANAGE', target: 'MANAGE.1.1', type: 'function-subcategory' },
    { source: 'MANAGE', target: 'MANAGE.2.1', type: 'function-subcategory' },
    
    // NIST 800-53 Family to Control mappings
    { source: 'AC', target: 'AC-2', type: 'family-control' },
    { source: 'AC', target: 'AC-3', type: 'family-control' },
    { source: 'AU', target: 'AU-2', type: 'family-control' },
    { source: 'CM', target: 'CM-6', type: 'family-control' },
    { source: 'IA', target: 'IA-2', type: 'family-control' },
    { source: 'IR', target: 'IR-4', type: 'family-control' },
    { source: 'RA', target: 'RA-2', type: 'family-control' },
    { source: 'SA', target: 'SA-11', type: 'family-control' },
    { source: 'SC', target: 'SC-7', type: 'family-control' },
    { source: 'SI', target: 'SI-4', type: 'family-control' },
    { source: 'SR', target: 'SR-1', type: 'family-control' },
    
    // ATLAS Tactic to Technique mappings
    { source: 'RECONNAISSANCE', target: 'AML.T0000', type: 'tactic-technique' },
    { source: 'RESOURCE-DEVELOPMENT', target: 'AML.T0002', type: 'tactic-technique' },
    { source: 'INITIAL-ACCESS', target: 'AML.T0010', type: 'tactic-technique' },
    { source: 'AI-MODEL-ACCESS', target: 'AML.T0040', type: 'tactic-technique' },
    { source: 'DISCOVERY', target: 'AML.T0013', type: 'tactic-technique' },
    { source: 'AI-ATTACK-STAGING', target: 'AML.T0005', type: 'tactic-technique' },
    { source: 'EXECUTION', target: 'AML.T0011', type: 'tactic-technique' },
    { source: 'PERSISTENCE', target: 'AML.T0020', type: 'tactic-technique' },
    { source: 'PRIVILEGE-ESCALATION', target: 'AML.T0053', type: 'tactic-technique' },
    { source: 'DEFENSE-EVASION', target: 'AML.T0015', type: 'tactic-technique' },
    { source: 'CREDENTIAL-ACCESS', target: 'AML.T0055', type: 'tactic-technique' },
    { source: 'COLLECTION', target: 'AML.T0035', type: 'tactic-technique' },
    { source: 'COMMAND-AND-CONTROL', target: 'AML.T0072', type: 'tactic-technique' },
    { source: 'EXFILTRATION', target: 'AML.T0024', type: 'tactic-technique' },
    { source: 'IMPACT', target: 'AML.T0015-IMPACT', type: 'tactic-technique' },
    
    // NIST AI RMF Subcategory to NIST 800-53 Control mappings
    { source: 'GOVERN.1.1', target: 'RA-2', type: 'rmf-80053' },
    { source: 'GOVERN.1.2', target: 'CM-6', type: 'rmf-80053' },
    { source: 'MAP.1.1', target: 'CM-6', type: 'rmf-80053' },
    { source: 'MAP.1.2', target: 'RA-2', type: 'rmf-80053' },
    { source: 'MEASURE.1.1', target: 'RA-2', type: 'rmf-80053' },
    { source: 'MEASURE.2.1', target: 'SI-4', type: 'rmf-80053' },
    { source: 'MEASURE.2.1', target: 'AU-2', type: 'rmf-80053' },
    { source: 'MANAGE.1.1', target: 'IR-4', type: 'rmf-80053' },
    { source: 'MANAGE.2.1', target: 'IR-4', type: 'rmf-80053' },
    
    // NIST 800-53 Controls to AISVS Category mappings
    { source: 'AC-2', target: 'C5', type: '80053-aisvs' },
    { source: 'AC-3', target: 'C5', type: '80053-aisvs' },
    { source: 'AU-2', target: 'C4', type: '80053-aisvs' },
    { source: 'CM-6', target: 'C4', type: '80053-aisvs' },
    { source: 'IA-2', target: 'C5', type: '80053-aisvs' },
    { source: 'IR-4', target: 'C13', type: '80053-aisvs' },
    { source: 'RA-2', target: 'C3', type: '80053-aisvs' },
    { source: 'SA-11', target: 'C8', type: '80053-aisvs' },
    { source: 'SC-7', target: 'C6', type: '80053-aisvs' },
    { source: 'SI-4', target: 'C4', type: '80053-aisvs' },
    { source: 'SI-4', target: 'C13', type: '80053-aisvs' },
    { source: 'SR-1', target: 'C8', type: '80053-aisvs' },
    
    // Direct NIST AI RMF Subcategory to AISVS Category mappings
    { source: 'GOVERN.1.1', target: 'C1', type: 'rmf-aisvs' },
    { source: 'GOVERN.1.1', target: 'C5', type: 'rmf-aisvs' },
    { source: 'GOVERN.1.1', target: 'C11', type: 'rmf-aisvs' },
    { source: 'GOVERN.1.2', target: 'C1', type: 'rmf-aisvs' },
    { source: 'GOVERN.1.2', target: 'C3', type: 'rmf-aisvs' },
    { source: 'MAP.1.1', target: 'C3', type: 'rmf-aisvs' },
    { source: 'MAP.1.1', target: 'C4', type: 'rmf-aisvs' },
    { source: 'MAP.1.2', target: 'C3', type: 'rmf-aisvs' },
    { source: 'MEASURE.1.1', target: 'C3', type: 'rmf-aisvs' },
    { source: 'MEASURE.2.1', target: 'C4', type: 'rmf-aisvs' },
    { source: 'MEASURE.2.1', target: 'C13', type: 'rmf-aisvs' },
    { source: 'MANAGE.1.1', target: 'C1', type: 'rmf-aisvs' },
    { source: 'MANAGE.1.1', target: 'C2', type: 'rmf-aisvs' },
    { source: 'MANAGE.1.1', target: 'C3', type: 'rmf-aisvs' },
    { source: 'MANAGE.1.1', target: 'C4', type: 'rmf-aisvs' },
    { source: 'MANAGE.1.1', target: 'C5', type: 'rmf-aisvs' },
    { source: 'MANAGE.2.1', target: 'C13', type: 'rmf-aisvs' },
    
    // ATLAS to NIST AI RMF mappings (attack patterns to risk management)
    { source: 'RECONNAISSANCE', target: 'MAP.1.1', type: 'atlas-rmf' },
    { source: 'RECONNAISSANCE', target: 'MAP.1.2', type: 'atlas-rmf' },
    { source: 'RESOURCE-DEVELOPMENT', target: 'GOVERN.1.2', type: 'atlas-rmf' },
    { source: 'INITIAL-ACCESS', target: 'MANAGE.1.1', type: 'atlas-rmf' },
    { source: 'AI-MODEL-ACCESS', target: 'MANAGE.1.1', type: 'atlas-rmf' },
    { source: 'DISCOVERY', target: 'MAP.1.1', type: 'atlas-rmf' },
    { source: 'AI-ATTACK-STAGING', target: 'MANAGE.1.1', type: 'atlas-rmf' },
    { source: 'EXECUTION', target: 'MANAGE.2.1', type: 'atlas-rmf' },
    { source: 'PERSISTENCE', target: 'MANAGE.1.1', type: 'atlas-rmf' },
    { source: 'PRIVILEGE-ESCALATION', target: 'MANAGE.1.1', type: 'atlas-rmf' },
    { source: 'DEFENSE-EVASION', target: 'MEASURE.2.1', type: 'atlas-rmf' },
    { source: 'CREDENTIAL-ACCESS', target: 'MANAGE.1.1', type: 'atlas-rmf' },
    { source: 'COLLECTION', target: 'MEASURE.2.1', type: 'atlas-rmf' },
    { source: 'COMMAND-AND-CONTROL', target: 'MEASURE.2.1', type: 'atlas-rmf' },
    { source: 'EXFILTRATION', target: 'MANAGE.2.1', type: 'atlas-rmf' },
    { source: 'IMPACT', target: 'MANAGE.2.1', type: 'atlas-rmf' },
    
    // ATLAS to NIST 800-53 mappings (attack techniques to security controls)
    { source: 'AML.T0000', target: 'RA-2', type: 'atlas-80053' },
    { source: 'AML.T0002', target: 'SA-11', type: 'atlas-80053' },
    { source: 'AML.T0010', target: 'SC-7', type: 'atlas-80053' },
    { source: 'AML.T0040', target: 'AC-3', type: 'atlas-80053' },
    { source: 'AML.T0013', target: 'SI-4', type: 'atlas-80053' },
    { source: 'AML.T0005', target: 'CM-6', type: 'atlas-80053' },
    { source: 'AML.T0011', target: 'SI-4', type: 'atlas-80053' },
    { source: 'AML.T0020', target: 'AC-2', type: 'atlas-80053' },
    { source: 'AML.T0053', target: 'IA-2', type: 'atlas-80053' },
    { source: 'AML.T0015', target: 'SI-4', type: 'atlas-80053' },
    { source: 'AML.T0055', target: 'IA-2', type: 'atlas-80053' },
    { source: 'AML.T0035', target: 'SI-4', type: 'atlas-80053' },
    { source: 'AML.T0072', target: 'SC-7', type: 'atlas-80053' },
    { source: 'AML.T0024', target: 'SI-4', type: 'atlas-80053' },
    { source: 'AML.T0015-IMPACT', target: 'SI-4', type: 'atlas-80053' },
    
    // ATLAS to AISVS mappings (attack techniques to verification standards)
    { source: 'AML.T0000', target: 'C3', type: 'atlas-aisvs' },
    { source: 'AML.T0002', target: 'C8', type: 'atlas-aisvs' },
    { source: 'AML.T0010', target: 'C4', type: 'atlas-aisvs' },
    { source: 'AML.T0040', target: 'C5', type: 'atlas-aisvs' },
    { source: 'AML.T0013', target: 'C4', type: 'atlas-aisvs' },
    { source: 'AML.T0005', target: 'C4', type: 'atlas-aisvs' },
    { source: 'AML.T0011', target: 'C2', type: 'atlas-aisvs' },
    { source: 'AML.T0020', target: 'C5', type: 'atlas-aisvs' },
    { source: 'AML.T0053', target: 'C5', type: 'atlas-aisvs' },
    { source: 'AML.T0015', target: 'C10', type: 'atlas-aisvs' },
    { source: 'AML.T0055', target: 'C5', type: 'atlas-aisvs' },
    { source: 'AML.T0035', target: 'C1', type: 'atlas-aisvs' },
    { source: 'AML.T0072', target: 'C6', type: 'atlas-aisvs' },
    { source: 'AML.T0024', target: 'C1', type: 'atlas-aisvs' },
    { source: 'AML.T0015-IMPACT', target: 'C10', type: 'atlas-aisvs' },
  ],
};

// Developer-friendly mapping data structure
export const mappingMetadata = {
  frameworks: {
    nistRmf: {
      name: 'NIST AI Risk Management Framework',
      version: '1.0',
      description: 'Framework for managing AI risks',
      url: 'https://www.nist.gov/itl/ai-risk-management-framework'
    },
    nist80053: {
      name: 'NIST 800-53 Revision 5',
      version: 'Rev 5',
      description: 'Security and privacy controls for federal information systems',
      url: 'https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final'
    },
    aisvs: {
      name: 'OWASP AI Security Verification Standard',
      version: '1.0',
      description: 'Comprehensive framework for verifying AI system security',
      url: 'https://owasp.org/www-project-ai-security-verification-standard/'
    },
    atlas: {
      name: 'MITRE ATLAS',
      version: '4.9.0',
      description: 'Adversarial Threat Landscape for Artificial-Intelligence Systems',
      url: 'https://atlas.mitre.org/'
    }
  },
  nodeTypes: {
    'nist-function': { color: '#3B82F6', size: 20, label: 'NIST RMF Function' },
    'nist-subcategory': { color: '#60A5FA', size: 15, label: 'NIST RMF Subcategory' },
    'nist-80053-family': { color: '#8B5CF6', size: 18, label: 'NIST 800-53 Family' },
    'nist-80053-control': { color: '#A78BFA', size: 12, label: 'NIST 800-53 Control' },
    'aisvs-category': { color: '#10B981', size: 16, label: 'AISVS Category' },
    'atlas-tactic': { color: '#EF4444', size: 18, label: 'ATLAS Tactic' },
    'atlas-technique': { color: '#F87171', size: 14, label: 'ATLAS Technique' }
  },
  linkTypes: {
    'function-subcategory': { color: '#3B82F6', width: 2, label: 'Function → Subcategory' },
    'family-control': { color: '#8B5CF6', width: 2, label: 'Family → Control' },
    'tactic-technique': { color: '#EF4444', width: 2, label: 'Tactic → Technique' },
    'rmf-80053': { color: '#F59E0B', width: 1.5, label: 'RMF → 800-53' },
    '80053-aisvs': { color: '#EF4444', width: 1.5, label: '800-53 → AISVS' },
    'rmf-aisvs': { color: '#10B981', width: 1.5, label: 'RMF → AISVS' },
    'atlas-rmf': { color: '#8B5CF6', width: 1.5, label: 'ATLAS → RMF' },
    'atlas-80053': { color: '#F59E0B', width: 1.5, label: 'ATLAS → 800-53' },
    'atlas-aisvs': { color: '#10B981', width: 1.5, label: 'ATLAS → AISVS' }
  }
}; 